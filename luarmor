

local SCRIPT_ID = "42f92b639d0394ac5806de25b07e26d5"
local LOADER_URL = "https://api.luarmor.net/files/v4/loaders/42f92b639d0394ac5806de25b07e26d5.lua"
local KEY_FILE = "LHub_Key.txt"
local GET_KEY_LINK = "https://ads.luarmor.net/get_key?for=-LnDzsGFTqXOu"

-- expose executor key everywhere Luarmor may read
if script_key and #script_key == 32 then
    _G.script_key = script_key
    getgenv().script_key = script_key

    local ok = pcall(function()
        loadstring(game:HttpGet(LOADER_URL))()
    end)

    if ok then
        -- save key for next time
        if writefile then
            writefile(KEY_FILE, script_key)
        end
        return -- STOP SCRIPT, HUB LOADED
    end
end



if isfile and isfile(KEY_FILE) then
    local savedKey = string.gsub(readfile(KEY_FILE), "%s+", "")

    if #savedKey == 32 then
        script_key = savedKey
        _G.script_key = savedKey
        getgenv().script_key = savedKey

        local ok = pcall(function()
            loadstring(game:HttpGet(LOADER_URL))()
        end)

        if ok then
            return -- STOP SCRIPT, HUB LOADED
        else
            delfile(KEY_FILE)
        end
    end
end



local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()

local Window = Rayfield:CreateWindow({
    Name = "L Hub! Key Loader",
    LoadingTitle = "Enter Key",
    LoadingSubtitle = "by L",
    ToggleUIKeybind = "L",
})

local KeyTab = Window:CreateTab("Key System")
local UserKey = ""

KeyTab:CreateButton({
    Name = "Copy Key Link",
    Callback = function()
        setclipboard(GET_KEY_LINK)
    end
})

KeyTab:CreateInput({
    Name = "Enter Key",
    PlaceholderText = "Paste your 32-char key here",
    Callback = function(text)
        UserKey = string.gsub(text or "", "%s+", "")
    end
})

KeyTab:CreateButton({
    Name = "Verify Key",
    Callback = function()
        if #UserKey ~= 32 then
            Rayfield:Notify({
                Title = "Invalid Key",
                Content = "Key must be 32 characters",
                Duration = 3
            })
            return
        end

        -- expose key
        script_key = UserKey
        _G.script_key = UserKey
        getgenv().script_key = UserKey

        local ok = pcall(function()
            loadstring(game:HttpGet(LOADER_URL))()
        end)

        if ok then
            writefile(KEY_FILE, UserKey)
            Rayfield:Destroy()
        else
            Rayfield:Notify({
                Title = "Invalid Key",
                Content = "Key verification failed",
                Duration = 3
            })
        end
    end
})
